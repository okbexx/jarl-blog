<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在VPS中利用vlmcsd搭建KMS激活服务器 | Hello </title>
    <meta name="description" content="coding for u">
    
    
    <link rel="preload" href="/jarl-blog/assets/css/styles.fe427f5e.css" as="style"><link rel="preload" href="/jarl-blog/assets/js/app.fe427f5e.js" as="script"><link rel="preload" href="/jarl-blog/assets/js/7.26befcb2.js" as="script"><link rel="prefetch" href="/jarl-blog/assets/js/1.227c5aa2.js"><link rel="prefetch" href="/jarl-blog/assets/js/2.787a90d6.js"><link rel="prefetch" href="/jarl-blog/assets/js/3.39dbfe68.js"><link rel="prefetch" href="/jarl-blog/assets/js/4.97a143cc.js"><link rel="prefetch" href="/jarl-blog/assets/js/5.d362521b.js"><link rel="prefetch" href="/jarl-blog/assets/js/6.8e8e1947.js"><link rel="prefetch" href="/jarl-blog/assets/js/8.7667da81.js"><link rel="prefetch" href="/jarl-blog/assets/js/9.b4ca5f1f.js">
    <link rel="stylesheet" href="/jarl-blog/assets/css/styles.fe427f5e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="page-main"><div class="component-nav-menu"><div class="placeholder"></div><div class="search-wrapper"><div aria-haspopup="listbox" role="combobox" aria-owns="el-autocomplete-3712" class="el-autocomplete"><div class="el-input el-input--prefix"><!----><input type="text" autocomplete="off" valueKey="title" placeholder="请输入内容" fetchSuggestions="function () { [native code] }" triggerOnFocus="true" debounce="300" placement="bottom-start" popperAppendToBody="true" background-color="#eee" value="" class="el-input__inner"><span class="el-input__prefix"><i class="el-input__icon el-icon-search"></i></span><!----><!----></div><div role="region" class="el-autocomplete-suggestion el-popper" style="width:;display:none;"><div class="el-scrollbar"><div class="el-autocomplete-suggestion__wrap el-scrollbar__wrap el-scrollbar__wrap--hidden-default"><ul class="el-scrollbar__view el-autocomplete-suggestion__list"></ul></div><div class="el-scrollbar__bar is-horizontal"><div class="el-scrollbar__thumb" style="width:0;transform:translateX(0%);ms-transform:translateX(0%);webkit-transform:translateX(0%);"></div></div><div class="el-scrollbar__bar is-vertical"><div class="el-scrollbar__thumb" style="height:0;transform:translateY(0%);ms-transform:translateY(0%);webkit-transform:translateY(0%);"></div></div></div></div></div></div><ul role="menubar" class="el-menu--horizontal el-menu" style="background-color:;"><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;">
        Home
      </li><li role="menuitem" tabindex="-1" class="el-menu-item is-active" style="color:;border-bottom-color:;background-color:;">
        Blog
      </li><li role="menuitem" aria-haspopup="true" class="el-submenu"><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          我的项目
        <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;">
          cytoscape-relate
        </li></ul></div></li></ul></div><div class="page-container"><div class="component-page"><div class="page-content"><!----><div class="content custom"><blockquote><p>如今我们经常会使用 KMS 对我们的 Windows/Office 进行激活，不过市面上流通着不少良莠不齐的 KMS 激活软件。其实，我们完全可以利用手中的闲置 VPS 资源，利用 vlmcsd 搭建KMS 激活服务器。声明仅 VOL 版本的 Windows/Office 支持此 KMS 激活，请先确认自己安装的非 Retail 零售版。</p></blockquote><h3 id="搭建服务器"><a href="#搭建服务器" aria-hidden="true" class="header-anchor">#</a> 搭建服务器</h3><p>首先需要一台 VPS，在上面搭建 vlmcsd 服务端</p><ol><li>下载最新版，查看最新版本 <a href="https://github.com/Wind4/vlmcsd/releases" target="_blank" rel="noopener noreferrer">github地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol><div class="language- extra-class"><pre class="language-text"><code>    wget https://github.com/Wind4/vlmcsd/releases/download/svn1111/binaries.tar.gz
</code></pre></div><ol start="2"><li>解压并查看</li></ol><div class="language- extra-class"><pre class="language-text"><code>    tar -zxvf binaries.tar.gz
    cd binaries/Linux/intel/static/
    ls
</code></pre></div><ol start="3"><li><p>挑选适合自己系统的版本，我们能看到适配各个系统的版本，vlmcsd-x64-musl-static 或vlmcsd-x86-musl-static（根据你 VPS 的系统为 x86 或 x64 系统而定）。</p><p>接着以 x64 为例子：</p></li></ol><div class="language- extra-class"><pre class="language-text"><code>    chmod u+x vlmcsd-x64-musl-static
    ./vlmcsd-x64-musl-static
</code></pre></div><p>​    至此，已经部署完毕</p><ol start="4"><li><p>如果你的 VPS 开启了 iptables ，记得开启 1688 端口的 tcp 传输：</p><p><code>iptables -I INPUT 5 -p tcp -m state --state NEW -m tcp --dport 1688 -j ACCEPT</code></p></li><li><p>开机自启</p></li></ol><div class="language- extra-class"><pre class="language-text"><code>    vi /etc/rc.local
    cd ~/binaries/Linux/intel/static/ &amp;&amp; ./vlmcsd-x64-musl-static
</code></pre></div><h3 id="本地测试"><a href="#本地测试" aria-hidden="true" class="header-anchor">#</a> 本地测试</h3><p>本地测试这里仅以本地为 Windows 环境为例</p><ol><li><p>下载 https://github.com/Wind4/vlmcsd/releases ，并解压</p></li><li><p>进入\binaries\Windows\intel 目录，开启 PowerShell 或者其他终端</p></li><li><p>根据你本地的 Windows 为 x86 或 x64，输入如下命令：</p></li></ol><div class="language- extra-class"><pre class="language-text"><code>  ./vlmcs-Windows-x86.exe -v -l 3 你的VPS的IP或者绑定的域名
</code></pre></div><p>或</p><div class="language- extra-class"><pre class="language-text"><code>  ./vlmcs-Windows-x64.exe -v -l 3 你的VPS的IP或者绑定的域名
</code></pre></div><p>​       其中 -l 3表示发送 Windows 10 Enterprise 2016 LTSB 的激活请求，具体版本对应列表可以通过 ./vlmcs-	Windows-x64.exe -x 查看</p><p>​       如果显示如下，那么就搭建成功了</p><p><img src="https://i.loli.net/2018/06/18/5b268a17629be.png" alt="kms.png"></p><h3 id="激活"><a href="#激活" aria-hidden="true" class="header-anchor">#</a> 激活</h3><ul><li><p>激活 Windows</p><p>以管理员身份打开命令提示符，然执行下列命令：</p></li></ul><div class="language- extra-class"><pre class="language-text"><code>    cd /d &quot;%SystemRoot%\system32&quot;
    slmgr /skms 你的VPS的IP或者绑定的域名
    slmgr /ato
    slmgr /xpr
</code></pre></div><p><img src="https://i.loli.net/2018/06/18/5b268a73549c1.png" alt="win.png"></p><ul><li><p>激活 Office</p><p>以管理员身份打开命令提示符，进入软件安装目录，然后执行下列命令：</p><p>这里以 Office 2013 为例：</p><p>进入32位版本安装目录：<code>cd /d &quot;%ProgramFiles(x86)%\Microsoft Office\Office15</code></p><p>进入64位版本安装目录：<code>cd /d &quot;%ProgramFiles%\Microsoft Office\Office15</code></p><p>然后执行下列命令</p><div class="language- extra-class"><pre class="language-text"><code>cscript ospp.vbs /sethst:你的VPS的IP或者绑定的域名
cscript ospp.vbs /act
cscript ospp.vbs /dstatus
</code></pre></div></li></ul><h3 id="题外话"><a href="#题外话" aria-hidden="true" class="header-anchor">#</a> 题外话</h3><p>​	Windows VOL 版本可以从 <a href="http://msdn.itellyou.cn/" target="_blank" rel="noopener noreferrer">http://msdn.itellyou.cn/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这里下载</p><p>​	Office VOL 版本可以从 <a href="https://landian.la/click/OfficeToolPlus.html" target="_blank" rel="noopener noreferrer">https://landian.la/click/OfficeToolPlus.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这里下载</p><p>​	VOL 版本的镜像一般内置 GVLK key，用于 KMS 激活。如果你		   手动输过其他 key，那么这个内置的 key 就会被替换掉，这个时候如果你想用 KMS，那么就需要把 GVLK key 输回去。首先，
到 <a href="https://technet.microsoft.com/en-us/library/jj612867.aspx" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 获取你对应版本的 key</p><p>​	如果不知道自己的系统是什么版本，可以运行以下命令查看系统版本：</p><div class="language- extra-class"><pre class="language-text"><code>  wmic os get caption
</code></pre></div><p>得到对应key之后，使用管理员权限运行cmd执行安装key：</p><div class="language- extra-class"><pre class="language-text"><code>  slmgr /ipk xxxxx-xxxxx-xxxxx-xxxxx
</code></pre></div><p>​	然后跟上面说的一样设置 KMS 服务器地址，激活。</p><p>KMS 方式激活的有效期只有180天，每隔一段时间系统会自动请求 KMS 服务器续期，只要你的服务器正常，续期就没问题
参考：</p><p><a href="https://luodaoyi.com/kms.html" target="_blank" rel="noopener noreferrer">https://luodaoyi.com/kms.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a href="https://yorkchou.com/vlmcsd.html" target="_blank" rel="noopener noreferrer">https://yorkchou.com/vlmcsd.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></div></div></div></div></div>
    <script src="/jarl-blog/assets/js/app.fe427f5e.js" defer></script><script src="/jarl-blog/assets/js/7.26befcb2.js" defer></script>
  </body>
</html>
